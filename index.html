<!DOCTYPE html>

<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Single Transferable Vote</title>
  <link rel="icon" href="data:,">
</head>

<body>

  <h1>Single Transferable Vote</h1>
  <button id="calcResult">Calculate vote result</button>

  <h2>Poll data</h2>
  <dl>
    <dt>Number of seats:</dt>
    <dd>
      <pre id="seats"></pre>
    </dd>
    <dt>Votes:</dt>
    <dd>
      <pre id="votes"></pre>
    </dd>
    <dt>Tie priority list:</dt>
    <dd>
      <pre id="tieRank"></pre>
    </dd>
  </dl>

  <h2>Result</h2>
  <pre id="result"></pre>

  <script src="./main.js"></script>
  <script>
    const seats = 2;
    const votes = [[1, 2, 3], [2, 1, 3], [3, 1, 2]];
    const tieRank = [1, 2, 3];

    document.getElementById("seats").textContent = JSON.stringify(seats);
    document.getElementById("votes").textContent = JSON.stringify(votes);
    document.getElementById("tieRank").textContent = JSON.stringify(tieRank);

    load_wasm("./main.wasm").then(function (single_transferable_vote) {
      document.getElementById("calcResult").onclick() = function () {
        const result = single_transferable_vote(seats, votes, tieRank);
        document.getElementById("result").textContent = JSON.stringify(result);
      };
    });
  </script>

</body>

</html>
